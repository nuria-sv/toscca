<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Thresholded Sparse CCA ‚Ä¢ toscca</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="48x48" href="favicon-48x48.png">
<link rel="icon" type="‚Äùimage/svg+xml‚Äù" href="favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" sizes="any" href="favicon.ico">
<link rel="manifest" href="site.webmanifest">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Thresholded Sparse CCA">
<meta property="og:description" content="Performs Thresholded Ordered Sparse CCA.">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">toscca</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/toscca-vignette.html">toscca-vignette</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="toscca-">toscca <img src="https://github.com/nuria-sv/toscca/blob/master/logo.png" height="132" width="110" align="right"><a class="anchor" aria-label="anchor" href="#toscca-"></a>
</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>toscca is an R package to perform Thresholded Ordered Sparse Canonical Correlation Analysis (TOSCCA), descibed in <a href="https://arxiv.org/abs/2310.02169" class="external-link">(Senar N. et al, nd)</a> for the analysis and integration of two datasets, at least one of which is high-dimensional. TOSCCA is an extension of the sparse CCA method based on soft-thresholding that produces near-orthogonal components, allows for browsing over various sparsity levels, and permutation-based hypothesis testing. Our soft-thresholding approach avoids tuning of a penalty parameter, which is computationally burdensome and may render unintelligible results. In addition, unlike alternative approaches, our method is less dependent on the initialisation.</p>
<p><img src="https://github.com/nuria-sv/toscca/blob/master/algorithm.png" height="380" width="700" align="center"></p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of toscca from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"nuria-sv/toscca"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>This is a basic example which shows you how to reproduce the analysis described in ‚ÄúA framework for interpretation and testing of sparse canonical correlations‚Äù.</p>
</div>
<div class="section level2">
<h2 id="simulations">Simulations<a class="anchor" aria-label="anchor" href="#simulations"></a>
</h2>
<p>We simulate data for 3 underlying signals of different size on a high-dimensional setting. That is,</p>
<p><span class="math display">$$
\mathbf{X} \in \mathbb{R}^{n\times p} \quad \text{and} \quad \mathbf{Y}\in \mathbb{R}^{n\times q},
\\
\text{where } n = 100, \text{ } p = 2500 \text{ and } q = 500.
$$</span></p>
</div>
<div class="section level2">
<h2 id="canonical-correlation-analysis">Canonical Correlation Analysis<a class="anchor" aria-label="anchor" href="#canonical-correlation-analysis"></a>
</h2>
<p>We use the method described in the paper, Thresholded Ordered Sparse Canonical Correlation Analysis (TOSCCA), to uncover the underlying processes linking the data.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">X</span> <span class="op">=</span> <span class="fu"><a href="reference/standardVar.html">standardVar</a></span><span class="op">(</span><span class="va">X0</span><span class="op">)</span></span>
<span><span class="va">Y</span> <span class="op">=</span> <span class="fu"><a href="reference/standardVar.html">standardVar</a></span><span class="op">(</span><span class="va">Y0</span><span class="op">)</span></span>
<span><span class="va">K</span> <span class="op">=</span> <span class="fl">4</span>                                       <span class="co"># number of components to be estimated</span></span>
<span><span class="va">nonz_x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">K</span><span class="op">)</span>                        <span class="co"># number of nonzero variables for X</span></span>
<span><span class="va">nonz_y</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">K</span><span class="op">)</span>                        <span class="co"># number of nonzero variables for Y</span></span>
<span><span class="va">init</span>   <span class="op">=</span> <span class="st">"uniform"</span>                          <span class="co"># type of initialisation</span></span>
<span><span class="va">cca_toscca</span>  <span class="op">=</span> <span class="fu"><a href="reference/toscca.html">toscca</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span>, <span class="va">nonz_x</span>, <span class="va">nonz_y</span>, <span class="va">K</span>, <span class="va">init</span>, combination <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; __________________________________________ </span></span>
<span><span class="co">#&gt;  For component K =  1 : </span></span>
<span><span class="co">#&gt; | . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .  | 100 %          Common convergence error: 0 &amp; Iterations: 4 </span></span>
<span><span class="co">#&gt; k-fold cv max. cancor </span></span>
<span><span class="co">#&gt;             0.9999466 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  ........................................ </span></span>
<span><span class="co">#&gt;  # nonzero A: 100</span></span>
<span><span class="co">#&gt;  # nonzero B: 100</span></span>
<span><span class="co">#&gt;  ........................................</span></span></code></pre></div>
<p><img src="reference/figures/README-toscca-1.png" width="100%"></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co">#&gt; __________________________________________ </span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co">#&gt;  For component K =  2 : </span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#&gt; | . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .  | 100 %          Common convergence error: 0 &amp; Iterations: 9 </span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co">#&gt; k-fold cv max. cancor </span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#&gt;             0.9706823 </span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co">#&gt;  ........................................ </span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co">#&gt;  # nonzero A: 100</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co">#&gt;  # nonzero B: 100</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co">#&gt;  ........................................</span></span></code></pre></div>
<p><img src="reference/figures/README-toscca-2.png" width="100%"></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co">#&gt; __________________________________________ </span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co">#&gt;  For component K =  3 : </span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co">#&gt; | . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .  | 100 %          Common convergence error: 0 &amp; Iterations: 14 </span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co">#&gt; k-fold cv max. cancor </span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#&gt;             0.9181017 </span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt;  ........................................ </span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co">#&gt;  # nonzero A: 100</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co">#&gt;  # nonzero B: 100</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="co">#&gt;  ........................................</span></span></code></pre></div>
<p><img src="reference/figures/README-toscca-3.png" width="100%"></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="co">#&gt; __________________________________________ </span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co">#&gt;  For component K =  4 : </span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#&gt; | . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .  | 100 %          Common convergence error: 0.01821 &amp; Iterations: 21 </span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co">#&gt; k-fold cv max. cancor </span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co">#&gt;             0.1844584 </span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="co">#&gt;  ........................................ </span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co">#&gt;  # nonzero A: 100</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="co">#&gt;  # nonzero B: 100</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="co">#&gt;  ........................................</span></span></code></pre></div>
<p><img src="reference/figures/README-toscca-4.png" width="100%"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cpev_toscca</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">K</span>, <span class="kw">function</span><span class="op">(</span><span class="va">k</span><span class="op">)</span> <span class="fu">cpev.fun</span><span class="op">(</span><span class="va">X</span>, <span class="va">X</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">cca_toscca</span><span class="op">$</span><span class="va">alpha</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="va">k</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">perm_toscca</span> <span class="op">=</span> <span class="fu">perm.toscca</span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span>, <span class="va">nonz_x</span>, <span class="va">nonz_y</span>, K <span class="op">=</span> <span class="va">K</span>, <span class="va">init</span>, draws <span class="op">=</span> <span class="fl">100</span>, cancor <span class="op">=</span> <span class="va">cca_toscca</span><span class="op">$</span><span class="va">cancor</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in e$fun(obj, substitute(ex), parent.frame(), e$data): already</span></span>
<span><span class="co">#&gt; exporting variable(s): K</span></span></code></pre></div>
<p><img src="reference/figures/README-toscca-5.png" width="100%"></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co">#&gt; Empirical p-values:</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="co">#&gt; 0</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co">#&gt; 0</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co">#&gt; 0</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co">#&gt; 0.17</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">#&gt; NULL</span></span></code></pre></div>
<p>We repeat the analysis using the Penalised Matrix Analysis approach from the PMA R-package. I have modified the main function to allow for different initialisations (such as random uniform and random normal) to compare to our models‚Äô performance.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pma_lambda</span> <span class="op">=</span> <span class="fu">PMA</span><span class="fu">::</span><span class="fu">CCA.permute</span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span>, typex <span class="op">=</span> <span class="st">"standard"</span>, typez <span class="op">=</span> <span class="st">"standard"</span><span class="op">)</span></span>
<span><span class="va">cca_pma</span> <span class="op">=</span> <span class="fu">CCA_pma_random</span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span>, K <span class="op">=</span> <span class="fl">4</span>, typex <span class="op">=</span> <span class="st">"standard"</span>, typez <span class="op">=</span> <span class="st">"standard"</span>, start <span class="op">=</span> <span class="st">"uniform"</span>, </span>
<span>                         penaltyx <span class="op">=</span> <span class="va">pma_lambda</span><span class="op">$</span><span class="va">bestpenaltyx</span>, <span class="va">pma_lambda</span><span class="op">$</span><span class="va">bestpenaltyz</span><span class="op">)</span></span>
<span><span class="co">#&gt; 123456789101112131415</span></span>
<span><span class="co">#&gt; 123456789101112131415</span></span>
<span><span class="co">#&gt; 123456789101112131415</span></span>
<span><span class="co">#&gt; 123456789101112131415</span></span></code></pre></div>
<p><img src="reference/figures/README-plots-1.png" width="100%"></p>
<p>Then we run the algorithm several times with different sparsity levels for <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ±</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>, keeping those for <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ≤</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math> fixed. We observed the variables making up the signal are repeatedly selected with a higher frequency than the noise variables. The implication being that noise variable are selected once the signal has been retrieved.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co">#&gt; nonzero_b must have length 1 or K.</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="co">#&gt; nonzero_b must have length 1 or K.</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="co">#&gt; nonzero_b must have length 1 or K.</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co">#&gt; nonzero_b must have length 1 or K.</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co">#&gt; nonzero_b must have length 1 or K.</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co">#&gt; nonzero_b must have length 1 or K.</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="co">#&gt; nonzero_b must have length 1 or K.</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="co">#&gt; nonzero_b must have length 1 or K.</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-3-1.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="cummulative-percentage-of-explained-variance-cpev-and-correlation-between-components">Cummulative percentage of explained variance (CPEV) and correlation between components.<a class="anchor" aria-label="anchor" href="#cummulative-percentage-of-explained-variance-cpev-and-correlation-between-components"></a>
</h2>
<p>AS discussed in the paper, a common measure to evaluated whether or not to compute another component is the CPEV, as seen in the equation below. However, if the estimated canonical vectors are correlated, then the subsequent components are limited in the amount of new information they are bringing by adding one more of them.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mrow><mi>t</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>ùõÑ</mi><mi>k</mi><mi>T</mi></msubsup><msub><mi>ùõÑ</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><msup><mi>ùêó</mi><mi>T</mi></msup><mi>ùêó</mi></mrow></mfrac><annotation encoding="application/x-tex">
\frac{tr(\mathbf{\gamma}_k^T\mathbf{\gamma}_k)}{\mathbf{X}^T\mathbf{X}}
</annotation></semantics></math></p>
<p>We therefore scale the CPEV according to correlation between previous components. We refer to this as adjusted CPEV.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>C</mi><mi>P</mi><mi>E</mi><mi>V</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ùõÑ</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>C</mi><mi>P</mi><mi>E</mi><mi>V</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ùõÑ</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚ãÖ</mo><munder><mo>‚àè</mo><mrow><mi>i</mi><mo>&lt;</mo><mi>k</mi></mrow></munder><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><mrow><mo stretchy="true" form="prefix">|</mo><mi>c</mi><mi>o</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ùõÑ</mi><mi>i</mi></msub><mo>,</mo><msub><mi>ùõÑ</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">|</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="1.0em"></mspace><mrow><mtext mathvariant="normal">for </mtext><mspace width="0.333em"></mspace></mrow><mi>k</mi><mo>=</mo><mn>2</mn><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><mi>K</mi></mrow><annotation encoding="application/x-tex">
 ACPEV(\mathbf{\gamma}_k) = CPEV(\mathbf{\gamma}_k)\cdot\prod_{i&lt;k}(1 - |cor(\mathbf{\gamma}_i, \mathbf{\gamma}_k)|), \quad \text{for } k = 2, \dots, K
</annotation></semantics></math></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cpev_pma</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">K</span>, <span class="kw">function</span><span class="op">(</span><span class="va">k</span><span class="op">)</span> <span class="fu">cpev.fun</span><span class="op">(</span><span class="va">X</span>, <span class="va">X</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">cca_pma</span><span class="op">$</span><span class="va">u</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="va">k</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">auto_cor</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>first_second <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">cca_pma</span><span class="op">$</span><span class="va">u</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> , <span class="va">cca_pma</span><span class="op">$</span><span class="va">u</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>, </span>
<span>                                 <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">cca_toscca</span><span class="op">$</span><span class="va">alpha</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">cca_toscca</span><span class="op">$</span><span class="va">alpha</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                      first_third  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">cca_pma</span><span class="op">$</span><span class="va">u</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> , <span class="va">cca_pma</span><span class="op">$</span><span class="va">u</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span>, </span>
<span>                                 <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">cca_toscca</span><span class="op">$</span><span class="va">alpha</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">cca_toscca</span><span class="op">$</span><span class="va">alpha</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                      first_fourth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">cca_pma</span><span class="op">$</span><span class="va">u</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> , <span class="va">cca_pma</span><span class="op">$</span><span class="va">u</span><span class="op">[</span>,<span class="fl">4</span><span class="op">]</span><span class="op">)</span>, </span>
<span>                                 <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">cca_toscca</span><span class="op">$</span><span class="va">alpha</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">cca_toscca</span><span class="op">$</span><span class="va">alpha</span><span class="op">[</span>,<span class="fl">4</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                      second_third <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">cca_pma</span><span class="op">$</span><span class="va">u</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> , <span class="va">cca_pma</span><span class="op">$</span><span class="va">u</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span>, </span>
<span>                                 <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">cca_toscca</span><span class="op">$</span><span class="va">alpha</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, <span class="va">cca_toscca</span><span class="op">$</span><span class="va">alpha</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                      second_fourth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">cca_pma</span><span class="op">$</span><span class="va">u</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> , <span class="va">cca_pma</span><span class="op">$</span><span class="va">u</span><span class="op">[</span>,<span class="fl">4</span><span class="op">]</span><span class="op">)</span>, </span>
<span>                                 <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">cca_toscca</span><span class="op">$</span><span class="va">alpha</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, <span class="va">cca_toscca</span><span class="op">$</span><span class="va">alpha</span><span class="op">[</span>,<span class="fl">4</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                      third_fourth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">cca_pma</span><span class="op">$</span><span class="va">u</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span> , <span class="va">cca_pma</span><span class="op">$</span><span class="va">u</span><span class="op">[</span>,<span class="fl">4</span><span class="op">]</span><span class="op">)</span>, </span>
<span>                                 <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">cca_toscca</span><span class="op">$</span><span class="va">alpha</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span>, <span class="va">cca_toscca</span><span class="op">$</span><span class="va">alpha</span><span class="op">[</span>,<span class="fl">4</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">auto_cor</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PMA"</span>, <span class="st">"TOSCCA"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">adj_cpev_toscca</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">cpev_toscca</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="va">K</span>, <span class="kw">function</span><span class="op">(</span><span class="va">k</span><span class="op">)</span> <span class="va">cpev_toscca</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/prod.html" class="external-link">prod</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">auto_cor</span><span class="op">[</span><span class="fl">2</span>,<span class="va">k</span><span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="va">k</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">adj_cpev_pma</span>    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">cpev_pma</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="va">K</span>, <span class="kw">function</span><span class="op">(</span><span class="va">k</span><span class="op">)</span> <span class="va">cpev_pma</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/prod.html" class="external-link">prod</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">auto_cor</span><span class="op">[</span><span class="fl">1</span>,<span class="va">k</span><span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="va">k</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">auto_cor</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"b"</span>, pch <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"deepskyblue"</span>, xlab <span class="op">=</span> <span class="st">"Correlation to first component"</span>, ylab <span class="op">=</span> <span class="st">"Autocorrelation"</span>, xaxt <span class="op">=</span> <span class="st">"n"</span>, yaxt<span class="op">=</span><span class="st">"n"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">1</span>, at<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">auto_cor</span><span class="op">)</span><span class="op">)</span>, lab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">auto_cor</span><span class="op">)</span>, las<span class="op">=</span><span class="fl">0</span>, cex.axis <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">2</span>, at<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/pretty.html" class="external-link">pretty</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>, lab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/pretty.html" class="external-link">pretty</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>, las<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span>nx <span class="op">=</span> <span class="cn">NULL</span>, ny <span class="op">=</span> <span class="cn">NULL</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="fu">alpha</span><span class="op">(</span><span class="st">"lightgray"</span>, <span class="fl">0.4</span><span class="op">)</span>,lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">auto_cor</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"b"</span>, pch <span class="op">=</span> <span class="fl">15</span>, col <span class="op">=</span> <span class="st">"tomato"</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-4-1.png" width="100%"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">(</span><span class="va">adj_cpev_toscca</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"b"</span>, pch <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"deepskyblue"</span>, xlab <span class="op">=</span> <span class="st">"Component"</span>, ylab <span class="op">=</span> <span class="st">"Adjusted CPEV"</span>, xaxt <span class="op">=</span> <span class="st">"n"</span>, yaxt<span class="op">=</span><span class="st">"n"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">adj_cpev_pma</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">adj_cpev_toscca</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">1</span>, at<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="va">K</span>, lab<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="va">K</span>, las<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">2</span>, at<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/pretty.html" class="external-link">pretty</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">adj_cpev_pma</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">adj_cpev_toscca</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, lab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/pretty.html" class="external-link">pretty</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">adj_cpev_pma</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">adj_cpev_toscca</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, las<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span>nx <span class="op">=</span> <span class="cn">NULL</span>, ny <span class="op">=</span> <span class="cn">NULL</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="fu">alpha</span><span class="op">(</span><span class="st">"lightgray"</span>, <span class="fl">0.4</span><span class="op">)</span>,lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="op">(</span><span class="va">adj_cpev_pma</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"b"</span>, pch <span class="op">=</span> <span class="fl">15</span>, col <span class="op">=</span> <span class="st">"tomato"</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-4-2.png" width="100%"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="fu">kable</span><span class="op">(</span></span>
<span>  <span class="va">auto_cor</span>,</span>
<span>  col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">auto_cor</span><span class="op">)</span>,</span>
<span>  <span class="co"># row.names = row.names(auto_cor),</span></span>
<span>  <span class="co"># digits = 2,</span></span>
<span>  caption <span class="op">=</span> <span class="st">"Autocorrelation between components"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="8%">
<col width="15%">
<col width="14%">
<col width="15%">
<col width="15%">
<col width="16%">
<col width="15%">
</colgroup>
<thead><tr>
<th align="left"></th>
<th align="right">first_second</th>
<th align="right">first_third</th>
<th align="right">first_fourth</th>
<th align="right">second_third</th>
<th align="right">second_fourth</th>
<th align="right">third_fourth</th>
</tr></thead>
<tbody>
<tr>
<td align="left">PMA</td>
<td align="right">-0.0101010</td>
<td align="right">0.7069568</td>
<td align="right">-0.2151539</td>
<td align="right">0.0346192</td>
<td align="right">0.0100014</td>
<td align="right">-0.3398326</td>
</tr>
<tr>
<td align="left">TOSCCA</td>
<td align="right">-0.0131597</td>
<td align="right">-0.0130300</td>
<td align="right">-0.0022242</td>
<td align="right">-0.0063520</td>
<td align="right">-0.0067584</td>
<td align="right">-0.0056898</td>
</tr>
</tbody>
</table>
<p>Autocorrelation between components</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">adj_cpev</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">adj_cpev_pma</span>, <span class="va">adj_cpev_toscca</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">adj_cpev</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PMA"</span>, <span class="st">"TOSCCA"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">adj_cpev</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"K"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">K</span><span class="op">)</span></span>
<span><span class="fu">kable</span><span class="op">(</span></span>
<span>  <span class="va">adj_cpev</span>,</span>
<span>  col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">adj_cpev_pma</span><span class="op">)</span>,</span>
<span>  <span class="co"># row.names = row.names(auto_cor),</span></span>
<span>  <span class="co"># digits = 2,</span></span>
<span>  caption <span class="op">=</span> <span class="st">"Autocorrelation between components"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<table class="table"><tbody>
<tr>
<td align="left">PMA</td>
<td align="right">0.0019351</td>
<td align="right">0.0076611</td>
<td align="right">0.0050515</td>
<td align="right">0.0060542</td>
</tr>
<tr>
<td align="left">TOSCCA</td>
<td align="right">0.0068149</td>
<td align="right">0.0073004</td>
<td align="right">0.0079377</td>
<td align="right">0.0081198</td>
</tr>
</tbody></table>
<p>Autocorrelation between components</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing toscca</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Nuria Senar <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-1004-5785" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Nuria Senar.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
